#### 线性回归

1. 线性回归公式的推导

假设$y=mx+b$是所有坐标点$(x_n,y_n)$的拟合曲线，则可计算出期望值和真实值之间的平方差，即可得出$m，b$的值:
$$
SE_{line} =(y_1-(mx_1+b))^2+(y_2-(mx_2+b))^2+...+(y_n-(mx_n+b))^2
$$
        推导公式得出：
$$
SE_{line}=n\overline{y^2}-2mn\overline{xy}-2bn\overline{y}+m^2n\overline{x^2}+2mbn\overline{x}+nb^2
$$

         学过偏导的了解$m,n$在这个函数中相当于一个“bowl”形状的三维图，当函数值最小时，m和n的斜率都为零

则对$m$和$n$进行求导,并使其值等于零：
$$
-2n\overline{xy}+2mn\overline{x^2}+2bn\overline{x}=0
$$
则对$n​$进行求导,并使其值等于零：
$$
-2n\overline{y}+2mn\overline{x}+2nb=0
$$
可求$m$的值为：
$$
m = \frac{(\overline{x}\overline{y}-\overline{xy})}{(\overline{x})^2-\overline{x^2}}
$$
带入b的方程式中得：
$$
b = \overline{y}-m\overline{x}
$$
**决定系数$R^2​$(coefficient of determination)**

​        对于直线拟合程度更有意义得估计：$y$得波动程度有多少百分比能被$x$得波动程度所描述(How much (what %) of the variation in y is described by the variation in x)

​    Total variation in y :    the squared error from the average of y ($SE_{\overline{y}}$)

​       how much of the total variation in not described by the regression line?
$$
\frac{SE_{line}}{SE_{\overline{y}}}
$$
则，$R^2$:
$$
R^2 = 1-\frac{SE_{line}}{SE_{\overline{y}}}
$$

2. 协方差（covariance）和回归线
   $$
   Cov(x,y)=E[(x - E(x)(Y-E(Y))]
   $$

#### $X^2$分布（Chi-squared）

卡方检验是一种用途很广的计数资料的假设检验方法。它属于非参数检验的范畴，主要是比较两个及两个以上样本率( 构成比）以及两个分类变量的关联性分析。其根本思想就是在于比较理论频数和实际频数的吻合程度或拟合优度问题。

​        比如每个类别独立，没有交叉得数据

$X^2$用于衡量实际值与理论值的差异程度（也就是卡方检验的核心思想），包含了以下两个信息：
1. 实际值与理论值偏差的绝对大小（由于平方的存在，差异是被放大的）
2. 差异程度与理论值的相对大小

自由度等于V = (行数 - 1) * (列数 - 1)，对四格表，自由度V = 1。

$X^2$公式为：
$$
x^2=\sum{\frac{(A-E)^2}{E}}=\sum_{i=1}^k{\frac{(A_i-E_i)^2}{E_i}},(i = 1,2,3,...,k)
$$
$X^2$临界值一般选取临界值（p=0.05），当依照$X^2$分布得临界值结果小于实验中得$X^2​$值时，则拒绝0假设

#### 方差分析（Analysis of variance/ANOVA）

实验中，我们要考察的指标为**试验指标**，影响的条件成为**因素**。由于各种因素的影响，使得测试数据结果呈波动状，包含不可控的**随机因素**、人为调控的**可控因素**。

**应用条件：**

1. 各样本是相互独立的随机样本

2. 各样本均来自正态分布总体

3. 各样本的总体方差相等，即具有方差齐性

##### **单因素方差分析（one-way ANOVA)**

*试验参数*

假设因素A有s个水平$A_1,A_2,…..,A_s$，每个水平下进行$nj$次独立试验，样本总数$n$.

 观测变量**总离差平方和** **=** **组间离差平方和** **+** **组内离差平方和**，表述为：**SST=SSA+SSE**。

**组内差异**——测量误差、个体差异

​        **SSE**（误差平方和）各个水平下，样本观察值与样本均值差异的平方和

​        组内自由度  **dfe=n-s**

**组间差异**——不同实验条件处理

​        **SSA**（因素A的效应平方和）各个水平下样本平均值与数据总平均差异的平方和

​        组间自由度  **dfa=s-1**

**均方 = 离差平方和 / 自由度   SA=SSA/dfa   SE=SSE/dfe**

*基本步骤*：

1. 提出原假设

2. 选择检验统计量:方差分析采用的检验统计量是F统计量，即F值检验.

3. 计算检验统计量得观测值和概率$p$值

4. 给定显著性水平，并作出决策

   **F分布**：设$X,Y$为两个独立得随机变量，$X$服从自由度为$K_1$的$X^2$分布，$Y$服从自由度为$K_2$的$X^2$分分布，变量$F=\frac{\frac{X}{K_1}}{\frac{Y}{K_2}}$服从$F(K_1,K_2)的分布。

**方差齐性检验**：对控制变量不同水平下各观测变量总体方差是否相等进行检验，控制变量不同水平下观测变量总体方差无显著差异是方差分析的前提要求；**若不满足**，便不能认为各总体分布相同。

**多重比较检验**：控制变量的不同水平对观测变量的影响程度如何，实现对各个水平下观测变量总体均值的逐对比较。

##### 多因素方差分析（multi-way ANOVA):

**单独效应**：其他因素固定，某一因素不同水平之间均数的差别

**交互效应**：某因素的单独效应，随另一因素水平而变化，且不能用随机误差解释

**试验参数**

​        假设因素A有​$r$个水平​$A_1,A_2,…..,A_r$，因素B有$s$个水平$B_1,B_2,……,B_s$,每个AB组合进行t次独立试验，样本总数为$n$.    

**所有数据平均值μ，αi是水平Ai的效应，βj是水平Bj的效应，γij表示Ai与Bj的交互作用**
$$
u_{ij}=u+a_i+β_j+γ_{ij}
$$
同样计算离差平方和**SST=SSA+SSE+SSB+SSAB**

**SSE**（误差平方和）:每个$ij$水平下测量值与均值差异的平方和；**SSA**、**SSB**（因素A\B的效应平方和）；**SSAB**（AB交互效应平方和）

**例如双因素方差分析的基本步骤**

1. 提出原假设：

|            | 因素A（r） | 因素B（s） | AB交互作用（rs） |
| :--------: | :--------: | :--------: | :--------------: |
| 无显著差异 |    H01     |    H02     |       H03        |
| 有显著差异 |    H11     |    H12     |       H13        |

2. F值检验

| 拒绝H01 |  F0.05(dfa,dfe)<FA  | 因素A不同存在显著差异 |
| :-----: | :-----------------: | :-------------------: |
| 拒绝H02 |  F0.05(dfb,dfe)<FB  | 因素B不同存在显著差异 |
| 拒绝H03 | F0.05(dfab,dfe)<FAB | 因素A与B存在交互效应  |

































































































































































